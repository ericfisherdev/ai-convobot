@tailwind base;
@tailwind components;
@tailwind utilities;
 

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 240 10% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 240 10% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 240 10% 3.9%;
    --primary: 346.8 77.2% 49.8%;
    --primary-foreground: 355.7 100% 97.3%;
    --secondary: 240 4.8% 95.9%;
    --secondary-foreground: 240 5.9% 10%;
    --muted: 240 4.8% 95.9%;
    --muted-foreground: 240 3.8% 46.1%;
    --accent: 240 4.8% 95.9%;
    --accent-foreground: 240 5.9% 10%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 5.9% 90%;
    --input: 240 5.9% 90%;
    --ring: 346.8 77.2% 49.8%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 20 14.3% 4.1%;
    --foreground: 0 0% 95%;
    --card: 24 9.8% 10%;
    --card-foreground: 0 0% 95%;
    --popover: 0 0% 9%;
    --popover-foreground: 0 0% 95%;
    --primary: 346.8 77.2% 49.8%;
    --primary-foreground: 355.7 100% 97.3%;
    --secondary: 240 3.7% 15.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 15%;
    --muted-foreground: 240 5% 64.9%;
    --accent: 12 6.5% 15.1%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 85.7% 97.3%;
    --border: 240 3.7% 15.9%;
    --input: 240 3.7% 15.9%;
    --ring: 346.8 77.2% 49.8%;
  }
  
  /* High contrast mode */
  .high-contrast {
    --border: 0 0% 50%;
    --input: 0 0% 50%;
  }
  
  .high-contrast.dark {
    --border: 0 0% 70%;
    --input: 0 0% 70%;
    --muted-foreground: 0 0% 80%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

body {
  height: 100vh;
  height: calc(var(--vh, 1vh) * 100);
  padding: 0;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  -webkit-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

@layer utilities {
  .max-container {
    @apply max-w-5xl mx-auto sm:px-16 pb-12 px-8 h-full flex flex-col gap-2 items-center;
    height: calc(var(--vh, 1vh) * 100);
    min-height: -webkit-fill-available;
  }
  
  /* Mobile-specific utilities */
  .mobile-safe-area {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  
  /* Touch-optimized buttons */
  .touch-target {
    min-height: 44px;
    min-width: 44px;
    touch-action: manipulation;
  }
  
  /* Improved scrolling */
  .smooth-scroll {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }
  
  /* Font size classes */
  .font-xs {
    font-size: 0.75rem;
  }
  
  .font-sm {
    font-size: 0.875rem;
  }
  
  .font-md {
    font-size: 1rem;
  }
  
  .font-lg {
    font-size: 1.125rem;
  }
  
  .font-xl {
    font-size: 1.25rem;
  }
  
  /* Font family classes */
  .font-system {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  }
  
  .font-sans {
    font-family: ui-sans-serif, system-ui, sans-serif;
  }
  
  .font-serif {
    font-family: ui-serif, Georgia, serif;
  }
  
  .font-mono {
    font-family: ui-monospace, SFMono-Regular, 'Cascadia Code', 'Roboto Mono', monospace;
  }
  
  /* Compact mode */
  .compact-mode .chat {
    padding-top: 0.25rem;
    padding-bottom: 0.25rem;
  }
  
  .compact-mode .chat-bubble {
    padding: 0.5rem 0.75rem;
    min-height: 2rem;
  }
  
  .compact-mode .max-container {
    gap: 0.5rem;
  }
  
  /* Animations disabled */
  .animations-disabled * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
  
  /* Animation delays for typing indicator */
  .animation-delay-100 {
    animation-delay: 0.1s;
  }
  
  .animation-delay-200 {
    animation-delay: 0.2s;
  }
  
  /* Enhanced animations */
  @keyframes slide-in-from-right {
    from {
      transform: translateX(50%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  @keyframes slide-in-from-left {
    from {
      transform: translateX(-50%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  .animate-in {
    animation-fill-mode: both;
  }
  
  .slide-in-from-right-5 {
    animation: slide-in-from-right 0.3s ease-out;
  }
  
  .slide-in-from-left-5 {
    animation: slide-in-from-left 0.3s ease-out;
  }
  
  .fade-in-0 {
    animation: fadeIn 0.2s ease-out;
  }
  
  .scale-in-95 {
    animation: scaleIn 0.2s ease-out;
  }
  
  .zoom-in-50 {
    animation: zoomIn 0.2s ease-out;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  @keyframes scaleIn {
    from { 
      opacity: 0;
      transform: scale(0.95);
    }
    to { 
      opacity: 1;
      transform: scale(1);
    }
  }
  
  @keyframes zoomIn {
    from { 
      opacity: 0;
      transform: scale(0.5);
    }
    to { 
      opacity: 1;
      transform: scale(1);
    }
  }
  
  /* Mobile-responsive breakpoints */
  @media (max-width: 640px) {
    .max-container {
      @apply px-4 pb-6 gap-1;
    }
    
    .chat-bubble {
      max-width: 95%;
      font-size: 0.9rem;
    }
    
    /* Larger touch targets on mobile */
    button, .touch-target {
      min-height: 48px;
      min-width: 48px;
      padding: 12px;
    }
    
    /* Better text input on mobile */
    textarea, input {
      font-size: 16px; /* Prevents zoom on iOS */
      -webkit-appearance: none;
      border-radius: 8px;
    }
    
    /* Improved drawer on mobile */
    .drawer-content {
      max-height: 85vh;
      border-radius: 16px 16px 0 0;
    }
    
    /* Hide scrollbars on mobile */
    .scroll-area {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    
    .scroll-area::-webkit-scrollbar {
      display: none;
    }
  }
  
  @media (max-width: 480px) {
    .chat {
      padding-top: 0.25rem;
      padding-bottom: 0.25rem;
      column-gap: 0.5rem;
    }
    
    .chat-bubble {
      padding: 0.625rem 0.875rem;
      max-width: 92%;
      font-size: 0.875rem;
    }
    
    /* Even more compact on very small screens */
    .max-container {
      @apply px-2 gap-0.5;
    }
  }
  
  /* Touch and gesture improvements */
  .touch-scroll {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-y: contain;
    scroll-behavior: smooth;
  }
  
  /* Prevent text selection on UI elements */
  button, .ui-element {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
  
  /* Allow text selection in content areas */
  .chat-bubble, textarea, input {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }
  
  /* Focus improvements for accessibility */
  button:focus, input:focus, textarea:focus {
    outline: 2px solid hsl(var(--ring));
    outline-offset: 2px;
  }
  
  /* Remove tap highlights */
  * {
    -webkit-tap-highlight-color: transparent;
  }
  
  /* Improved performance for animations */
  .animate-in, .chat {
    will-change: transform;
    transform: translateZ(0);
  }
  
  /* Message container layout styles */
  .message-container {
    padding: 0.5rem 0;
    margin: 0.25rem 0;
    transition: all 0.2s ease-in-out;
  }
  
  .message-header {
    min-height: 1.5rem;
  }
  
  .message-info {
    flex: 1;
  }
  
  .message-actions {
    flex-shrink: 0;
  }
  
  .message-content {
    width: 100%;
  }
  
  /* Compact mode for message containers */
  .compact-mode .message-container {
    padding: 0.25rem 0;
    margin: 0.125rem 0;
  }
  
  .compact-mode .message-header {
    min-height: 1.25rem;
  }
  
  /* Mobile responsive adjustments */
  @media (max-width: 640px) {
    .message-header {
      flex-wrap: wrap;
      gap: 0.25rem;
    }
    
    .message-actions {
      opacity: 1 !important; /* Always show on mobile */
    }
    
    .message-info {
      flex: 1 1 100%;
      order: 1;
    }
    
    .message-actions {
      flex: 0 0 auto;
      order: 2;
      align-self: flex-start;
    }
  }
  
  @media (max-width: 480px) {
    .message-container {
      padding: 0.25rem 0;
    }
    
    .message-header {
      margin-bottom: 0.5rem;
    }
    
    .message-actions button {
      min-width: 36px;
      min-height: 36px;
      padding: 6px;
    }
  }
}

.chat {
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  -moz-column-gap:.75rem;
  column-gap:.75rem;
  padding-top:.5rem;
  padding-bottom:.5rem;
  transition: all 0.2s ease-in-out;
}
.chat-image {
  grid-row:span 2 / span 2;
  align-self:flex-end
}
.chat-header {
  grid-row-start:1;
  font-size:.875rem;
  line-height:1.25rem
}
.chat-footer {
  grid-row-start:3;
  font-size:.875rem;
  line-height:1.25rem
}
.chat-bubble {
  position:relative;
  display:block;
  width:-moz-fit-content;
  width:fit-content;
  padding:.75rem 1rem;
  max-width:85%;
  border-radius:1.25rem;
  min-height:2.75rem;
  min-width:2.75rem;
  --tw-bg-opacity: 1;
  background-color:hsl(var(--secondary) / var(--tw-bg-opacity));
  --tw-text-opacity: 1;
  box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  transition: all 0.2s ease-in-out;
}
.chat-bubble:before {
  position:absolute;
  bottom:0px;
  height:.75rem;
  width:.75rem;
  background-color:inherit;
  content:"";
  -webkit-mask-size:contain;
  mask-size:contain;
  -webkit-mask-repeat:no-repeat;
  mask-repeat:no-repeat;
  -webkit-mask-position:center;
  mask-position:center
}
.chat-start {
  place-items:start;
  grid-template-columns:auto 1fr
}
.chat-start .chat-header,
.chat-start .chat-footer {
  grid-column-start:2
}
.chat-start .chat-image {
  grid-column-start:1
}
.chat-start .chat-bubble {
  grid-column-start:2;
  border-bottom-left-radius:0
}
.chat-start .chat-bubble:before {
  -webkit-mask-image:url("data:image/svg+xml,%3csvg width='3' height='3' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='black' d='m 0 3 L 3 3 L 3 0 C 3 1 1 3 0 3'/%3e%3c/svg%3e");
  mask-image:url("data:image/svg+xml,%3csvg width='3' height='3' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='black' d='m 0 3 L 3 3 L 3 0 C 3 1 1 3 0 3'/%3e%3c/svg%3e");
  left:-.749rem
}
[dir=rtl] .chat-start .chat-bubble:before {
  -webkit-mask-image:url("data:image/svg+xml,%3csvg width='3' height='3' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='black' d='m 0 3 L 1 3 L 3 3 C 2 3 0 1 0 0'/%3e%3c/svg%3e");
  mask-image:url("data:image/svg+xml,%3csvg width='3' height='3' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='black' d='m 0 3 L 1 3 L 3 3 C 2 3 0 1 0 0'/%3e%3c/svg%3e")
}
.chat-end {
  place-items:end;
  grid-template-columns:1fr auto
}
.chat-end .chat-header,
.chat-end .chat-footer {
  grid-column-start:1
}
.chat-end .chat-image {
  grid-column-start:2
}
.chat-end .chat-bubble {
  grid-column-start:1;
  border-bottom-right-radius:0
}
.chat-end .chat-bubble:before {
  -webkit-mask-image:url("data:image/svg+xml,%3csvg width='3' height='3' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='black' d='m 0 3 L 1 3 L 3 3 C 2 3 0 1 0 0'/%3e%3c/svg%3e");
  mask-image:url("data:image/svg+xml,%3csvg width='3' height='3' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='black' d='m 0 3 L 1 3 L 3 3 C 2 3 0 1 0 0'/%3e%3c/svg%3e");
  left:99.9%
}
[dir=rtl] .chat-end .chat-bubble:before {
  -webkit-mask-image:url("data:image/svg+xml,%3csvg width='3' height='3' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='black' d='m 0 3 L 3 3 L 3 0 C 3 1 1 3 0 3'/%3e%3c/svg%3e");
  mask-image:url("data:image/svg+xml,%3csvg width='3' height='3' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill='black' d='m 0 3 L 3 3 L 3 0 C 3 1 1 3 0 3'/%3e%3c/svg%3e")
}
